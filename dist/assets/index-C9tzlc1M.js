import{c as re,j as e,r as C,_ as $,S as oe,C as de}from"./index-CDf_FfrT.js";import{P as ce}from"./index-DNvDs65V.js";import{r as p}from"./router-GXfyPTrP.js";import{B as q}from"./button-BmATf1Bi.js";import{c as ie,d as me,C as xe,a as he}from"./card-BIU2y7oS.js";import{T as pe,a as je,b as z,c as h,d as ue,e as m,P as fe}from"./index-V6XNGBig.js";import{d as be,o as ge,F as Ne,j as ye,R as A,B as ve,e as we,f as u,T as ae}from"./file-upload-CydC68qV.js";import{R as Ie}from"./RHFTextArea-CvNhpCdH.js";import{u as Se,b as Ce,c as E}from"./useCustomQuery-D_zByj3Z.js";import{S as ne}from"./separator-DDXiVCpj.js";import{D as Pe}from"./index-ml6tbipm.js";import{B as Te}from"./book-open-BmdvmUSn.js";import{L as Me,H as ke}from"./layers-CUYCyimQ.js";import{C as Fe}from"./calendar-CmiNYZ_h.js";import{F as Be}from"./file-text-Ba4n1plx.js";import{B as qe}from"./badge-Cq50dHsH.js";import{D as Ae,a as De,b as $e,c as se}from"./dropdown-menu-BzIXi4GL.js";import{S as ze}from"./search-DC45ATN3.js";import{C as Ee}from"./circle-plus-skHhTY8t.js";import{S as te}from"./square-pen-Bv2lUeMv.js";import{f as le}from"./format-CWZx4aKk.js";import"./axios-DmypytPv.js";import"./chevron-right-bE6D0kJH.js";import"./index-CAeIp94X.js";import"./check-BaBhJQf0.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=re("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=re("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),He=we().shape({journalId:u().required("Journal is required"),volume:u().required("Volume is required"),issueNumber:u().required("Issue number is required"),title:u().required("Title is required"),publicationDate:u().required("Publication date is required"),description:u()});function Re({open:c,setOpen:f,title:o,id:b,edit:l,setEdit:g,refetch:P}){var k,F,B;const N=Se({}),D=Ce({}),{data:t,isFetching:T}=E({api:`${C.getIssueById}/${b}`,options:{enabled:l}}),x=E({api:`${C.getAllJournal}?page=1&limit=100`,options:{enabled:!0}}),s=be({defaultValues:{journalId:"",volume:"",issueNumber:"",title:"",publicationDate:"",description:""},resolver:ge(He)}),M=async r=>{var i;try{const d={...r};let n;l&&b?n=await D.mutateAsync({api:`${C.updateIssue}/${b}`,data:d}):n=await N.mutateAsync({api:C.createIssue,data:d}),(i=n.data)!=null&&i.success?($.success(n.data.message||"Success"),f(!1),g&&g(!1),P&&P()):$.error("Something went wrong")}catch{$.error("Failed to submit the form")}};return p.useEffect(()=>{var r,i,d,n,y,v,w,I,S;l&&t?s.reset({journalId:((i=(r=t==null?void 0:t.data)==null?void 0:r.journalId)==null?void 0:i._id)||((d=t==null?void 0:t.data)==null?void 0:d.journalId),volume:(n=t==null?void 0:t.data)==null?void 0:n.volume,issueNumber:(y=t==null?void 0:t.data)==null?void 0:y.issueNumber,title:(v=t==null?void 0:t.data)==null?void 0:v.title,publicationDate:(I=(w=t==null?void 0:t.data)==null?void 0:w.publicationDate)==null?void 0:I.split("T")[0],description:(S=t==null?void 0:t.data)==null?void 0:S.description}):s.reset({journalId:"",volume:"",issueNumber:"",title:"",publicationDate:"",description:""})},[l,t,s.reset]),e.jsx(Pe,{open:c,setOpen:f,title:o,setEdit:g,edit:l,isLoading:T,children:e.jsx(Ne,{methods:s,onSubmit:s.handleSubmit(M),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-gray-700",children:[e.jsx(Te,{className:"h-5 w-5"}),e.jsx("label",{className:"font-medium",children:"Journal"})]}),e.jsx(ye,{name:"journalId",data:(B=(F=(k=x==null?void 0:x.data)==null?void 0:k.data)==null?void 0:F.docs)==null?void 0:B.map(r=>({label:r.title,value:r._id}))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-gray-700",children:[e.jsx(Me,{className:"h-5 w-5"}),e.jsx("label",{className:"font-medium",children:"Volume"})]}),e.jsx(A,{name:"volume",placeholder:"Enter volume number",className:"w-full"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-gray-700",children:[e.jsx(ke,{className:"h-5 w-5"}),e.jsx("label",{className:"font-medium",children:"Issue Number"})]}),e.jsx(A,{name:"issueNumber",placeholder:"Enter issue number",className:"w-full"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-gray-700",children:[e.jsx(_e,{className:"h-5 w-5"}),e.jsx("label",{className:"font-medium",children:"Title"})]}),e.jsx(A,{name:"title",placeholder:"Enter issue title",className:"w-full"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-gray-700",children:[e.jsx(Fe,{className:"h-5 w-5"}),e.jsx("label",{className:"font-medium",children:"Publication Date"})]}),e.jsx(A,{name:"publicationDate",type:"date",className:"w-full"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 text-gray-700",children:[e.jsx(Be,{className:"h-5 w-5"}),e.jsx("label",{className:"font-medium",children:"Description"})]}),e.jsx(Ie,{name:"description",placeholder:"Enter description (optional)",className:"w-full min-h-[100px]"})]}),e.jsx(ne,{}),e.jsx("div",{children:e.jsxs(ve,{isLoading:s.formState.isSubmitting,type:"submit",className:"h-11 w-full rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-semibold flex items-center justify-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4"}),l?"Update Issue":"Create Issue"]})})]})})})}function Ve(){var r,i,d,n,y,v,w,I,S,L,_,H,R,V,J,O,U,G,K,Q,W,X,Y,Z;const[c,f]=p.useState(1),[o,b]=p.useState(10),[l,g]=p.useState(""),[P,N]=p.useState(!1),[D,t]=p.useState(""),[T,x]=p.useState(!1),s=E({api:`${C.getAllIssue}?page=${c}&limit=${o}&q=${l}`,key:"getAllIssues",value:[c,o,l],options:{enabled:!0}}),M=a=>{N(!0),x(!0),t(a)},k=a=>{g(a.target.value)},F=a=>{a.preventDefault(),f(1),s.refetch()},B=({issue:a})=>{var j;return e.jsx(xe,{className:"mb-4",children:e.jsxs(he,{className:"pt-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:a==null?void 0:a.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:[(j=a==null?void 0:a.journal)==null?void 0:j.title," â€¢ Vol. ",a==null?void 0:a.volume,", No. ",a==null?void 0:a.issueNumber]})]}),e.jsx(qe,{variant:"outline",children:le(new Date(a==null?void 0:a.publicationDate),"MMM d, yyyy")})]}),(a==null?void 0:a.description)&&e.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:a.description}),e.jsx("div",{className:"flex justify-between items-center mt-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(q,{size:"sm",onClick:()=>M(a==null?void 0:a._id),className:"flex items-center gap-1",children:[e.jsx(te,{size:14})," Edit"]}),e.jsxs(q,{size:"sm",variant:"destructive",className:"flex items-center gap-1",children:[e.jsx(ae,{size:14})," Delete"]})]})})]})})};return e.jsxs("main",{className:"container mx-auto px-4 py-6",children:[e.jsx(Re,{open:P,setOpen:N,title:T?"Edit Issue":"Add Issue",id:D,edit:T,setEdit:x,refetch:s.refetch}),e.jsx("div",{className:"bg-white rounded-lg shadow",children:e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[e.jsx(ie,{className:"text-xl font-bold",children:"Issue Management"}),e.jsxs("div",{className:"flex flex-col sm:flex-row w-full md:w-auto gap-3",children:[e.jsxs("form",{onSubmit:F,className:"relative w-full sm:w-64",children:[e.jsx("input",{type:"text",placeholder:"Search issues...",value:l,onChange:k,className:"w-full h-10 pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),e.jsx(ze,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]}),e.jsxs(q,{className:"flex items-center gap-2 whitespace-nowrap",onClick:()=>{x(!1),t(""),N(!0)},children:[e.jsx(Ee,{size:18}),"Add Issue"]})]})]}),e.jsxs(me,{className:"mb-4",children:["Total Issues: ",((i=(r=s.data)==null?void 0:r.data)==null?void 0:i.totalDocs)||0]}),s.isLoading?e.jsx("div",{className:"flex h-32 items-center justify-center",children:e.jsx(oe,{})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs(pe,{children:[e.jsx(je,{children:e.jsxs(z,{children:[e.jsx(h,{className:"w-12",children:"#"}),e.jsx(h,{children:"Journal"}),e.jsx(h,{children:"Title"}),e.jsx(h,{children:"Volume"}),e.jsx(h,{children:"Issue"}),e.jsx(h,{children:"Publication Date"}),e.jsx(h,{className:"text-right",children:"Actions"})]})}),e.jsx(ue,{children:((y=(n=(d=s==null?void 0:s.data)==null?void 0:d.data)==null?void 0:n.docs)==null?void 0:y.length)===0?e.jsx(z,{children:e.jsx(m,{colSpan:7,className:"text-center py-8",children:"No issues found"})}):(I=(w=(v=s==null?void 0:s.data)==null?void 0:v.data)==null?void 0:w.docs)==null?void 0:I.map((a,j)=>{var ee;return e.jsxs(z,{children:[e.jsx(m,{children:c*o-o+j+1}),e.jsx(m,{className:"font-medium",children:(ee=a==null?void 0:a.journal)==null?void 0:ee.title}),e.jsx(m,{children:a==null?void 0:a.title}),e.jsxs(m,{children:["Vol. ",a==null?void 0:a.volume]}),e.jsxs(m,{children:["No. ",a==null?void 0:a.issueNumber]}),e.jsx(m,{children:le(new Date(a==null?void 0:a.publicationDate),"MMM d, yyyy")}),e.jsx(m,{className:"text-right",children:e.jsxs(Ae,{children:[e.jsx(De,{asChild:!0,children:e.jsxs(q,{variant:"outline",size:"sm",className:"h-8 ml-auto flex items-center gap-1",children:["Actions ",e.jsx(de,{size:14})]})}),e.jsxs($e,{align:"end",children:[e.jsxs(se,{onClick:()=>M(a==null?void 0:a._id),children:[e.jsx(te,{size:14,className:"mr-2"})," Edit"]}),e.jsxs(se,{className:"text-red-600",children:[e.jsx(ae,{size:14,className:"mr-2"})," Delete"]})]})]})})]},a==null?void 0:a._id)})})]})}),e.jsx("div",{className:"md:hidden",children:((_=(L=(S=s==null?void 0:s.data)==null?void 0:S.data)==null?void 0:L.docs)==null?void 0:_.length)===0?e.jsx("div",{className:"text-center py-8",children:"No issues found"}):(V=(R=(H=s==null?void 0:s.data)==null?void 0:H.data)==null?void 0:R.docs)==null?void 0:V.map((a,j)=>e.jsx(B,{issue:a,index:j},a==null?void 0:a._id))}),e.jsx(ne,{className:"my-4"}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",(c-1)*o+1," to ",Math.min(c*o,((O=(J=s==null?void 0:s.data)==null?void 0:J.data)==null?void 0:O.totalDocs)||0)," of ",((G=(U=s==null?void 0:s.data)==null?void 0:U.data)==null?void 0:G.totalDocs)||0," entries"]}),e.jsx(fe,{page:c,perPage:o,totalPage:(Q=(K=s==null?void 0:s.data)==null?void 0:K.data)==null?void 0:Q.totalDocs,hasNextPage:(X=(W=s==null?void 0:s.data)==null?void 0:W.data)==null?void 0:X.hasNextPage,hasPrevPage:(Z=(Y=s==null?void 0:s.data)==null?void 0:Y.data)==null?void 0:Z.hasPrevPage,setPage:f,setPerPage:b})]})]})]})})]})}function ja(){return e.jsx(ce,{title:"Issue List",children:e.jsx("div",{children:e.jsx(Ve,{})})})}export{ja as default};
