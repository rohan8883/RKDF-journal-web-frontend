import{j as e,a as w,_ as m}from"./index-CcP31-MS.js";import{R as V,r as N,u as R}from"./router-GXfyPTrP.js";import{P as q}from"./index-BuLA2Zcz.js";import{u as C,C as L,g as $,d as b,o as P,F as S,R as F,B as k,e as O,f as g,h as I}from"./file-upload-RN2qJPxu.js";import{g as v}from"./services-KQnp_8oA.js";import{I as A}from"./label-BZX6spI0.js";import{u as E}from"./useCustomQuery-CyGYSctF.js";import{u as _}from"./useTimer-DqhrX62i.js";import{E as D,a as B}from"./select-CZPb9YGE.js";import"./axios-DmypytPv.js";import"./button-1B5J0yav.js";import"./index-CAeIp94X.js";function T({name:l,label:a,inputSize:i,inputValidation:r,...x}){const{control:n}=C(),[o,d]=V.useState(!1);return e.jsx(L,{name:l,control:n,render:({field:{ref:h,...t},fieldState:{error:s}})=>e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"text-gray-700 dark:text-gray-200",htmlFor:a,children:[a," ",s&&a&&e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(A,{...t,value:typeof t.value=="number"&&t.value===0?"":t.value,ref:h,className:`mt-1 ${s?"border-red-400":null}
              ${i==="small"&&"h-8"||i==="medium"&&"h-10"||i==="large"&&"h-12"||"h-9"}`,type:o?"text":"password",onInput:f=>{r&&$(f,r)},...x}),e.jsx("button",{type:"button",className:"absolute right-3 top-4",onClick:()=>d(f=>!f),children:o?e.jsx(D,{width:20,height:20}):e.jsx(B,{width:20,height:20})})]}),s&&e.jsx("span",{className:"text-red-400 text-xs",children:s==null?void 0:s.message})]})})}const H=O({email:g().email().required()});function M({next:l,data:a}){const i=E({}),r=b({defaultValues:{email:a.email},resolver:P(H)}),x=async n=>{var o,d,h,t;try{const s=await i.mutateAsync({api:w.sendOtpViaEmail,data:n});(o=s==null?void 0:s.data)!=null&&o.success?(l({...n,email:n==null?void 0:n.email,token:(d=s==null?void 0:s.data)==null?void 0:d.token}),m.success((h=s==null?void 0:s.data)==null?void 0:h.message)):m.error((t=s==null?void 0:s.data)==null?void 0:t.message)}catch(s){m.error(v(s))}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-6 lg:px-0 mx-auto max-w-sm mb-4",children:[e.jsx("div",{className:"flex justify-center"}),e.jsx("h1",{className:"text-3xl font-bold text-center mt-4 text-green-400",children:"Send OTP"}),e.jsx("p",{className:"text-center mt-2 text-muted-foreground text-xs",children:"Enter your email to send OTP to your email address"})]}),e.jsx(S,{methods:r,onSubmit:r.handleSubmit(x),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx(F,{className:"rounded-xl py-6 px-5 w-full bg-background",name:"email",inputValidation:["email","removeSpace"],placeholder:"Enter your email"})}),e.jsx("div",{children:e.jsx(k,{type:"submit",isLoading:r.formState.isSubmitting,className:"w-full rounded-xl py-5 px-4 mt-2 shadow-none",variant:"outline",children:"Send OTP"})})]})})]})}const G=O({email:g().email().required(),otp:g().required(),token:g().required()});function J({next:l,data:a,setData:i,prev:r}){const{minutes:x,seconds:n,togglerTimer:o,runTimer:d}=_(.5),h=E({}),t=b({defaultValues:{email:a.email,otp:a.otp,token:a.token},resolver:P(G)}),s=async p=>{var j,y,c;try{const u=await h.mutateAsync({api:w.verifyOtp,data:p});(j=u==null?void 0:u.data)!=null&&j.success?(l({...p,otp:p==null?void 0:p.otp}),m.success((y=u==null?void 0:u.data)==null?void 0:y.message)):m.error((c=u==null?void 0:u.data)==null?void 0:c.message)}catch(u){m.error(v(u))}};N.useEffect(()=>(o(),()=>{o()}),[]);const f=async()=>{var p,j,y;try{const c=await h.mutateAsync({api:w.sendOtpViaEmail,data:{email:a.email}});(p=c==null?void 0:c.data)!=null&&p.success?(m.success((j=c==null?void 0:c.data)==null?void 0:j.message),i({...a,otp:""}),t.setValue("otp",""),o()):m.error((y=c==null?void 0:c.data)==null?void 0:y.message)}catch(c){m.error(v(c))}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-6 lg:px-0 mx-auto max-w-sm mb-4",children:[e.jsx("div",{className:"flex justify-center"}),e.jsx("h1",{className:"text-3xl font-bold text-center mt-4 text-green-400",children:"Verify OTP"}),e.jsxs("h1",{className:"text-center mt-2 text-muted-foreground text-xs",children:["Verify your OTP to reset your password",e.jsxs("p",{className:"text-center text-muted-foreground text-xs text-green-400",children:[a.email,"  ",e.jsx("button",{onClick:()=>r(a),className:"text-center mt-2  text-sm text-green-400 cursor-pointer hover:text-green-500 underline",children:"Edit"})]})]})]}),e.jsx(S,{methods:t,onSubmit:t.handleSubmit(s),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx(F,{className:"rounded-xl py-6 px-5 w-full bg-background",name:"otp",inputValidation:["number","removeSpace"],placeholder:"Enter your OTP"})}),e.jsx("div",{children:e.jsx(k,{type:"submit",isLoading:t.formState.isSubmitting,className:"w-full rounded-xl py-5 px-4 mt-2 shadow-none",variant:"outline",children:"Verify OTP"})}),e.jsxs("div",{className:"text-center text-muted-foreground text-xs",children:[e.jsx("span",{children:"Didn't receive the OTP? "}),d?e.jsxs("span",{className:"text-center mt-2  text-sm text-green-400 cursor-pointer hover:text-green-500 underline",children:[x,":",n]}):e.jsx("button",{className:"text-center mt-2  text-sm text-green-400 cursor-pointer hover:text-green-500 underline",onClick:f,children:"Resend OTP"})]})]})})]})}const K=O({email:g().email().required(),token:g().required(),password:g().required(),confirmPassword:g().required().oneOf([I("password"),""],"Passwords must match")});function Q({data:l}){const a=R(),i=E({}),r=b({defaultValues:{email:l.email,password:l.password,confirmPassword:l.confirmPassword,token:l.token},resolver:P(K)}),x=async n=>{var o,d,h;try{const t=await i.mutateAsync({api:w.resetPassword,data:{email:n.email,password:n.password,token:n.token}});(o=t==null?void 0:t.data)!=null&&o.success?(m.success((d=t==null?void 0:t.data)==null?void 0:d.message),a("/lms-app/auth/login")):m.error((h=t==null?void 0:t.data)==null?void 0:h.message)}catch(t){m.error(v(t))}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-6 lg:px-0 mx-auto max-w-sm mb-4",children:[e.jsx("div",{className:"flex justify-center"}),e.jsx("h1",{className:"text-3xl font-bold text-center mt-4 text-green-400",children:"Reset Password"}),e.jsx("h1",{className:"text-center mt-2 text-muted-foreground text-xs",children:"Reset your password to login to your account"})]}),e.jsx(S,{methods:r,onSubmit:r.handleSubmit(x),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx(T,{className:"rounded-xl py-6 px-5 w-full bg-background",name:"password",placeholder:"Enter your OTP"})}),e.jsx("div",{className:"space-y-2",children:e.jsx(T,{className:"rounded-xl py-6 px-5 w-full bg-background",name:"confirmPassword",placeholder:"Enter your OTP"})}),e.jsx("div",{children:e.jsx(k,{type:"submit",isLoading:r.formState.isSubmitting,className:"w-full rounded-xl py-5 px-4 mt-2 shadow-none",variant:"outline",children:"Reset Password"})})]})})]})}function oe(){const[l,a]=N.useState(0),[i,r]=N.useState({email:"",otp:"",password:"",confirmPassword:"",token:""}),x=(o,d=!1)=>{r({...i,...o}),!d&&a(l+1)},n=o=>{r({...i,...o}),a(l-1)};return e.jsx(q,{title:"Login",children:e.jsx("div",{className:"flex flex-col w-full justify-center h-screen px-6 lg:px-0 mx-auto max-w-sm",children:{0:e.jsx(M,{next:x,data:i}),1:e.jsx(J,{next:x,prev:n,data:i,setData:r}),2:e.jsx(Q,{prev:n,data:i,setData:r})}[l]||null})})}export{oe as default};
